{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://luhtech.dev/schemas/roadmap-v2.1.json",
  "title": "LuhTech Roadmap Schema v2.1.0",
  "description": "Extended roadmap schema with features, releases, and version tracking. Additive extension of v2.0.0.",
  "type": "object",
  "required": ["$schema", "schemaVersion", "meta", "venture", "quarters"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Schema reference URL"
    },
    "schemaVersion": {
      "type": "string",
      "pattern": "^2\\.(0|1)\\.[0-9]+$",
      "description": "Schema version (2.0.x or 2.1.x)"
    },
    "meta": { "$ref": "#/definitions/meta" },
    "venture": { "$ref": "#/definitions/venture" },
    "pitch": { "$ref": "#/definitions/pitch" },
    
    "features": {
      "type": "array",
      "description": "User-facing capabilities (NEW in v2.1)",
      "items": { "$ref": "#/definitions/feature" }
    },
    
    "releases": {
      "type": "array",
      "description": "Versioned releases (NEW in v2.1)",
      "items": { "$ref": "#/definitions/release" }
    },
    
    "quarters": {
      "type": "object",
      "description": "Quarterly planning with deliverables",
      "patternProperties": {
        "^q[1-4]_20[0-9]{2}$": { "$ref": "#/definitions/quarter" }
      },
      "additionalProperties": false
    },
    
    "keyMilestones": {
      "type": "array",
      "description": "Critical milestones across quarters",
      "items": { "$ref": "#/definitions/keyMilestone" }
    },
    
    "flagshipFeatures": {
      "type": "array",
      "description": "Flagship features (legacy, use features[] instead)"
    },
    
    "featureSpecifications": {
      "type": "object",
      "description": "Feature specifications (legacy, use features[] instead)"
    },
    
    "metricsReporting": {
      "type": "object",
      "description": "Metrics and reporting data"
    },
    
    "completedMilestones": {
      "type": "array",
      "description": "Historical completed milestones"
    },
    
    "crossVentureDependencies": {
      "type": "array",
      "description": "Cross-venture dependencies"
    },
    
    "advancedFeatures": {
      "type": "object",
      "description": "Long-term advanced capabilities (legacy, use features[] instead)"
    },
    
    "financials": { "type": "object" },
    "team": { "type": "object" },
    "erikAllocation": { "type": "object" },
    "competitive": { "type": "object" },
    "traction": { "type": "object" }
  },
  
  "definitions": {
    "meta": {
      "type": "object",
      "required": ["ventureId", "ventureName", "status"],
      "properties": {
        "ventureId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Unique venture identifier"
        },
        "ventureName": {
          "type": "string",
          "description": "Display name"
        },
        "lastUpdated": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp"
        },
        "author": {
          "type": "string",
          "description": "Last editor"
        },
        "status": {
          "type": "string",
          "enum": ["active", "paused", "archived", "pre-formation", "pre-seed", "r&d", "poc", "concept"],
          "description": "Current venture status"
        },
        "sourceDoc": {
          "type": "string",
          "description": "Source document path"
        },
        "strategicDocuments": {
          "type": "array",
          "items": { "type": "string" },
          "description": "References to strategic documents"
        },
        "syncStatus": {
          "type": "object",
          "description": "Sync status metadata"
        },
        "repositoryType": {
          "type": "string",
          "enum": ["public", "private", "fork"],
          "description": "Repository visibility (NEW in v2.1)"
        },
        "upstreamRepo": {
          "type": "string",
          "description": "For forks, reference to upstream repository (NEW in v2.1)"
        }
      }
    },
    
    "feature": {
      "type": "object",
      "description": "User-facing product capability (NEW in v2.1)",
      "required": ["id", "name", "category", "status"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Unique feature identifier"
        },
        "name": {
          "type": "string",
          "maxLength": 100,
          "description": "Feature display name"
        },
        "category": {
          "type": "string",
          "enum": [
            "data-platform",
            "ai-ml",
            "collaboration",
            "visualization",
            "integration",
            "infrastructure",
            "security",
            "analytics"
          ],
          "description": "Feature category for grouping"
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "Brief description of capability"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "beta", "complete", "deprecated"],
          "description": "Current feature status"
        },
        "visibility": {
          "type": "string",
          "enum": ["public", "business", "both"],
          "default": "public",
          "description": "Which repo track this feature belongs to"
        },
        "startQuarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$",
          "description": "Development start quarter"
        },
        "targetQuarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$",
          "description": "Target completion quarter"
        },
        "targetReleaseId": {
          "type": "string",
          "description": "Target release version ID"
        },
        "deliverableIds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "IDs of deliverables composing this feature"
        },
        "completionMilestoneId": {
          "type": "string",
          "description": "Milestone ID marking feature completion"
        },
        "icon": {
          "type": "string",
          "maxLength": 4,
          "description": "Emoji or icon identifier"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "Feature priority (1=highest)"
        }
      }
    },
    
    "release": {
      "type": "object",
      "description": "Versioned release package (NEW in v2.1)",
      "required": ["id", "version", "status"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^v[0-9]+\\.[0-9]+\\.[0-9]+(-[a-z0-9.-]+)?$",
          "description": "Release identifier (e.g., v1.2.0, v1.0.0-business)"
        },
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-[a-z0-9.-]+)?$",
          "description": "SemVer version number"
        },
        "name": {
          "type": "string",
          "description": "Release codename (optional)"
        },
        "track": {
          "type": "string",
          "enum": ["public", "business"],
          "default": "public",
          "description": "Which version track (public vs business)"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-development", "rc", "released", "deprecated"]
        },
        "targetDate": {
          "type": "string",
          "format": "date",
          "description": "Target release date"
        },
        "releaseDate": {
          "type": "string",
          "format": "date",
          "description": "Actual release date"
        },
        "featureIds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Features included in this release"
        },
        "changelog": {
          "type": "object",
          "properties": {
            "features": {
              "type": "array",
              "items": { "type": "string" }
            },
            "enhancements": {
              "type": "array",
              "items": { "type": "string" }
            },
            "fixes": {
              "type": "array",
              "items": { "type": "string" }
            },
            "breaking": {
              "type": "array",
              "items": { "type": "string" }
            },
            "deprecated": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "milestoneId": {
          "type": "string",
          "description": "Associated milestone"
        },
        "gitTag": {
          "type": "string",
          "description": "Git tag for this release"
        },
        "gitCommit": {
          "type": "string",
          "pattern": "^[a-f0-9]{7,40}$",
          "description": "Release commit SHA"
        },
        "baseVersion": {
          "type": "string",
          "description": "For business track, the public version it's based on"
        }
      }
    },
    
    "deliverable": {
      "type": "object",
      "description": "Work item (EXTENDED in v2.1)",
      "required": ["name"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique deliverable identifier (NEW in v2.1)"
        },
        "$id": {
          "type": "string",
          "description": "URN identifier"
        },
        "name": {
          "type": "string",
          "description": "Deliverable name"
        },
        "type": {
          "type": "string",
          "enum": ["feature", "infrastructure", "documentation", "fix", "refactor"],
          "default": "feature",
          "description": "Work type classification (NEW in v2.1)"
        },
        "owner": {
          "type": "string",
          "default": "team",
          "description": "Responsible person or team"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "review", "complete", "blocked", "deferred"],
          "description": "Current status"
        },
        "progress": {
          "type": "string",
          "description": "Progress percentage"
        },
        "featureId": {
          "type": "string",
          "description": "Parent feature ID (NEW in v2.1)"
        },
        "targetReleaseId": {
          "type": "string",
          "description": "Target release version (NEW in v2.1)"
        },
        "feature": {
          "type": "string",
          "description": "Feature name reference"
        },
        "priority": {
          "type": ["integer", "string"],
          "description": "Priority (1=highest or 'critical')"
        },
        "hours": {
          "type": "integer",
          "minimum": 0,
          "description": "Estimated effort hours"
        },
        "effortHours": {
          "type": "integer",
          "minimum": 0,
          "description": "Estimated effort hours (alternate)"
        },
        "targetDate": {
          "type": "string",
          "description": "Target completion date"
        },
        "completedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Completion timestamp"
        },
        "evidence": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Verification criteria or links"
        },
        "successCriteria": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Success criteria"
        },
        "dependencies": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Dependency IDs"
        },
        "value": {
          "type": "object",
          "description": "Business value metrics"
        },
        "note": {
          "type": "string",
          "description": "Additional notes"
        },
        "completedComponents": {
          "type": "array",
          "items": { "type": "string" }
        },
        "remainingWork": {
          "type": "array",
          "items": { "type": "string" }
        }
      }
    },
    
    "quarter": {
      "type": "object",
      "required": ["focus"],
      "properties": {
        "focus": {
          "type": "string",
          "description": "Quarter focus area"
        },
        "theme": {
          "type": "string",
          "description": "Quarter theme"
        },
        "phases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Phase references"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "active", "complete"],
          "description": "Quarter status"
        },
        "milestones": {
          "type": "array",
          "items": { "$ref": "#/definitions/quarterMilestone" }
        },
        "deliverables": {
          "type": "array",
          "items": { "$ref": "#/definitions/deliverable" }
        },
        "metrics": {
          "type": "object",
          "additionalProperties": true
        },
        "resources": {
          "type": "object",
          "properties": {
            "team": { "type": ["integer", "string"] },
            "budget": { "type": "string" }
          }
        },
        "risks": {
          "type": "array",
          "items": { "$ref": "#/definitions/risk" }
        },
        "dependencies": {
          "type": "array",
          "items": { "$ref": "#/definitions/dependency" }
        },
        "erikHours": {
          "type": "integer",
          "minimum": 0,
          "maximum": 80,
          "description": "Erik's weekly hours"
        }
      }
    },
    
    "quarterMilestone": {
      "type": "object",
      "required": ["event"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique milestone identifier (NEW in v2.1)"
        },
        "date": {
          "type": "string",
          "description": "Target date"
        },
        "event": {
          "type": "string",
          "description": "Milestone name"
        },
        "gate": {
          "type": "boolean",
          "default": false,
          "description": "Go/no-go decision point"
        },
        "critical": {
          "type": "boolean",
          "default": false,
          "description": "Critical path"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "complete", "blocked"],
          "description": "Milestone status"
        },
        "type": {
          "type": "string",
          "enum": ["technical", "business", "funding", "team", "launch", "release", "ar-milestone"],
          "description": "Milestone category"
        },
        "dependsOn": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Dependent milestone IDs"
        }
      }
    },
    
    "keyMilestone": {
      "type": "object",
      "required": ["date", "event"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Milestone identifier"
        },
        "date": {
          "type": "string"
        },
        "event": {
          "type": "string"
        },
        "quarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$"
        },
        "gate": {
          "type": "boolean"
        },
        "critical": {
          "type": "boolean"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "complete", "blocked"]
        },
        "fundingRound": {
          "type": "string"
        }
      }
    },
    
    "risk": {
      "type": "object",
      "required": ["risk"],
      "properties": {
        "risk": { "type": "string" },
        "probability": {
          "type": "string",
          "enum": ["low", "medium", "medium-high", "high", "critical"]
        },
        "impact": {
          "type": "string",
          "enum": ["low", "medium", "medium-high", "high", "critical"]
        },
        "mitigation": { "type": "string" }
      }
    },
    
    "dependency": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["upstream", "downstream", "cross-venture", "internal", "external"]
        },
        "ventureId": { "type": "string" },
        "milestone": { "type": "string" },
        "blocking": { "type": "boolean", "default": false }
      }
    },
    
    "venture": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["Platform", "Application", "Hardware", "Service", "Marketplace", "Protocol", "Holding"]
        },
        "architecture": {
          "type": "string",
          "enum": ["Cloud-First", "Cloud-Native", "Edge-First", "Hybrid", "API-Only", "Platform"]
        },
        "status": {
          "type": "string",
          "enum": ["active", "paused", "archived", "pre-formation", "pre-seed", "r&d", "poc", "concept"]
        },
        "forkParent": {
          "type": ["string", "null"]
        },
        "codeReuse": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "domain": {
          "type": "string",
          "format": "hostname"
        },
        "repository": {
          "type": "string",
          "format": "uri"
        },
        "platformProgress": { "type": "string" },
        "currentPhase": { "type": "string" }
      }
    },
    
    "pitch": {
      "type": "object",
      "properties": {
        "oneLiner": { "type": "string", "maxLength": 150 },
        "problem": { "type": "string" },
        "solution": { "type": "string" },
        "market": { "type": "string" },
        "differentiator": { "type": "string" },
        "businessModel": { "type": "string" },
        "traction": { "type": "string" },
        "ask": { "type": "string" },
        "problemDetails": { "type": "object" },
        "solutionDetails": { "type": "object" },
        "marketDetails": { "type": "object" }
      }
    }
  }
}
