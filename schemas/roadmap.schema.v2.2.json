{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://luhtech.dev/schemas/roadmap-v2.2.json",
  "title": "LuhTech Roadmap Schema v2.2.0",
  "description": "Extended roadmap schema with resources block, vendor-agnostic features, and business field separation. Additive extension of v2.1.0.",
  "type": "object",
  "required": ["$schema", "schemaVersion", "meta", "venture", "quarters"],
  "properties": {
    "$schema": {
      "type": "string",
      "description": "Schema reference URL"
    },
    "schemaVersion": {
      "type": "string",
      "pattern": "^2\\.(0|1|2)\\.[0-9]+$",
      "description": "Schema version (2.0.x, 2.1.x, or 2.2.x)"
    },
    "meta": { "$ref": "#/definitions/meta" },
    "venture": { "$ref": "#/definitions/venture" },
    "pitch": { "$ref": "#/definitions/pitch" },
    
    "features": {
      "type": "array",
      "description": "User-facing capabilities",
      "items": { "$ref": "#/definitions/feature" }
    },
    
    "releases": {
      "type": "array",
      "description": "Versioned releases",
      "items": { "$ref": "#/definitions/release" }
    },
    
    "resources": {
      "type": "object",
      "description": "Infrastructure resource requirements (NEW in v2.2)",
      "$ref": "#/definitions/resources"
    },
    
    "quarters": {
      "type": "object",
      "description": "Quarterly planning with deliverables",
      "patternProperties": {
        "^q[1-4]_20[0-9]{2}$": { "$ref": "#/definitions/quarter" }
      },
      "additionalProperties": false
    },
    
    "keyMilestones": {
      "type": "array",
      "description": "Critical milestones across quarters",
      "items": { "$ref": "#/definitions/keyMilestone" }
    },
    
    "flagshipFeatures": {
      "type": "array",
      "description": "Flagship features with detailed specifications"
    },
    
    "metricsReporting": {
      "type": "object",
      "description": "Metrics and reporting data"
    },
    
    "completedMilestones": {
      "type": "array",
      "description": "Historical completed milestones"
    },
    
    "crossVentureDependencies": {
      "type": "array",
      "description": "Cross-venture dependencies"
    },
    
    "erikAllocation": { 
      "type": "object",
      "description": "Erik's time allocation across quarters"
    },
    
    "financials": { 
      "type": "object",
      "description": "DEPRECATED in v2.2 - Move to roadmap-business.json",
      "deprecated": true
    },
    "team": { 
      "type": "object",
      "description": "DEPRECATED in v2.2 - Move to roadmap-business.json",
      "deprecated": true
    },
    "competitive": { 
      "type": "object",
      "description": "DEPRECATED in v2.2 - Move to roadmap-business.json",
      "deprecated": true
    }
  },
  
  "definitions": {
    "meta": {
      "type": "object",
      "required": ["ventureId", "ventureName", "status"],
      "properties": {
        "ventureId": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Unique venture identifier"
        },
        "ventureName": {
          "type": "string",
          "description": "Display name"
        },
        "lastUpdated": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp"
        },
        "author": {
          "type": "string",
          "description": "Last editor"
        },
        "status": {
          "type": "string",
          "enum": ["active", "paused", "archived", "pre-formation", "pre-seed", "r&d", "poc", "concept", "planning"],
          "description": "Current venture status"
        },
        "sourceDoc": {
          "type": "string",
          "description": "Source document path"
        },
        "strategicDocuments": {
          "type": "array",
          "items": { "type": "string" },
          "description": "References to strategic documents"
        },
        "syncStatus": {
          "type": "object",
          "description": "Sync status metadata"
        },
        "repositoryType": {
          "type": "string",
          "enum": ["public", "private", "fork"],
          "description": "Repository visibility"
        },
        "upstreamRepo": {
          "type": "string",
          "description": "For forks, reference to upstream repository"
        },
        "schemaChangelog": {
          "type": "array",
          "description": "Schema version change history (NEW in v2.2)",
          "items": {
            "type": "object",
            "required": ["version", "date", "changes"],
            "properties": {
              "version": { "type": "string" },
              "date": { "type": "string", "format": "date" },
              "changes": {
                "type": "array",
                "items": { "type": "string" }
              }
            }
          }
        }
      }
    },
    
    "resources": {
      "type": "object",
      "description": "Infrastructure resource requirements (NEW in v2.2)",
      "properties": {
        "compute": {
          "type": "object",
          "description": "Compute/processing requirements",
          "properties": {
            "description": { "type": "string" },
            "items": {
              "type": "array",
              "items": { "$ref": "#/definitions/resourceItem" }
            }
          }
        },
        "storage": {
          "type": "object",
          "description": "Data storage requirements",
          "properties": {
            "description": { "type": "string" },
            "items": {
              "type": "array",
              "items": { "$ref": "#/definitions/resourceItem" }
            }
          }
        },
        "bandwidth": {
          "type": "object",
          "description": "Network/bandwidth requirements",
          "properties": {
            "description": { "type": "string" },
            "items": {
              "type": "array",
              "items": { "$ref": "#/definitions/resourceItem" }
            }
          }
        },
        "physical": {
          "type": "object",
          "description": "Physical hardware requirements",
          "properties": {
            "description": { "type": "string" },
            "items": {
              "type": "array",
              "items": { "$ref": "#/definitions/resourceItem" }
            }
          }
        },
        "personnel": {
          "type": "object",
          "description": "Team/headcount requirements",
          "properties": {
            "description": { "type": "string" },
            "reference": { 
              "type": "string",
              "description": "Reference to detailed personnel info (e.g., roadmap-business.json#/team)"
            },
            "summary": {
              "type": "object",
              "additionalProperties": { "type": ["integer", "string"] }
            }
          }
        }
      }
    },
    
    "resourceItem": {
      "type": "object",
      "description": "Individual resource requirement",
      "required": ["type", "purpose"],
      "properties": {
        "type": {
          "type": "string",
          "description": "Resource type (e.g., gpu, cpu, database, object, edge-storage)"
        },
        "spec": {
          "type": "string",
          "description": "Specification details"
        },
        "size": {
          "type": "string",
          "description": "Size/capacity"
        },
        "quantity": {
          "type": ["integer", "string"],
          "description": "Quantity needed"
        },
        "provider": {
          "type": "string",
          "description": "Service provider (optional, vendor-agnostic preferred)"
        },
        "estimate": {
          "type": "string",
          "description": "Estimated usage"
        },
        "purpose": {
          "type": "string",
          "description": "Purpose/use case"
        }
      }
    },
    
    "feature": {
      "type": "object",
      "description": "User-facing product capability",
      "required": ["id", "name", "category", "status"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]*$",
          "description": "Unique feature identifier"
        },
        "name": {
          "type": "string",
          "maxLength": 100,
          "description": "Feature display name"
        },
        "category": {
          "type": "string",
          "enum": [
            "data-platform",
            "ai-ml",
            "collaboration",
            "visualization",
            "integration",
            "infrastructure",
            "security",
            "analytics",
            "hardware",
            "mobile",
            "marketplace"
          ],
          "description": "Feature category for grouping"
        },
        "description": {
          "type": "string",
          "maxLength": 500,
          "description": "Brief description of capability"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "beta", "complete", "deprecated", "future"],
          "description": "Current feature status"
        },
        "visibility": {
          "type": "string",
          "enum": ["public", "business", "both"],
          "default": "public",
          "description": "Which repo track this feature belongs to"
        },
        "startQuarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$",
          "description": "Development start quarter"
        },
        "targetQuarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$",
          "description": "Target completion quarter"
        },
        "targetReleaseId": {
          "type": "string",
          "description": "Target release version ID"
        },
        "deliverableIds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "IDs of deliverables composing this feature"
        },
        "completionMilestoneId": {
          "type": "string",
          "description": "Milestone ID marking feature completion"
        },
        "icon": {
          "type": "string",
          "maxLength": 20,
          "description": "Emoji or icon identifier"
        },
        "priority": {
          "type": "integer",
          "minimum": 1,
          "maximum": 5,
          "description": "Feature priority (1=highest)"
        },
        "inheritedFrom": {
          "type": "string",
          "description": "Parent venture ID if feature is inherited (NEW in v2.2)"
        },
        "subdomainPattern": {
          "type": "string",
          "description": "Multi-tenant subdomain pattern (NEW in v2.2)"
        },
        "notes": {
          "type": "string",
          "description": "Additional implementation notes (NEW in v2.2)"
        },
        "vendorEvaluation": {
          "type": "object",
          "description": "Vendor evaluation status for vendor-agnostic features (NEW in v2.2)",
          "properties": {
            "status": {
              "type": "string",
              "enum": ["research-required", "evaluating", "selected", "deferred"]
            },
            "candidates": {
              "type": "array",
              "items": { "type": "string" }
            },
            "requirements": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Links to evaluation requirement docs"
            },
            "selectedVendor": {
              "type": "string",
              "description": "Selected vendor (if status=selected)"
            },
            "selectionDate": {
              "type": "string",
              "format": "date"
            }
          }
        }
      }
    },
    
    "release": {
      "type": "object",
      "description": "Versioned release package",
      "required": ["id", "version", "status"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^v[0-9]+\\.[0-9]+\\.[0-9]+(-[a-z0-9.-]+)?$",
          "description": "Release identifier (e.g., v1.2.0, v1.0.0-business)"
        },
        "version": {
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(-[a-z0-9.-]+)?$",
          "description": "SemVer version number"
        },
        "name": {
          "type": "string",
          "description": "Release codename (optional)"
        },
        "track": {
          "type": "string",
          "enum": ["public", "business"],
          "default": "public",
          "description": "Which version track (public vs business)"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-development", "rc", "released", "deprecated"]
        },
        "targetDate": {
          "type": "string",
          "format": "date",
          "description": "Target release date"
        },
        "releaseDate": {
          "type": "string",
          "format": "date",
          "description": "Actual release date"
        },
        "featureIds": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Features included in this release"
        },
        "changelog": {
          "type": "object",
          "properties": {
            "features": {
              "type": "array",
              "items": { "type": "string" }
            },
            "enhancements": {
              "type": "array",
              "items": { "type": "string" }
            },
            "fixes": {
              "type": "array",
              "items": { "type": "string" }
            },
            "breaking": {
              "type": "array",
              "items": { "type": "string" }
            },
            "deprecated": {
              "type": "array",
              "items": { "type": "string" }
            }
          }
        },
        "milestoneId": {
          "type": "string",
          "description": "Associated milestone"
        },
        "gitTag": {
          "type": "string",
          "description": "Git tag for this release"
        },
        "gitCommit": {
          "type": "string",
          "pattern": "^[a-f0-9]{7,40}$",
          "description": "Release commit SHA"
        },
        "baseVersion": {
          "type": "string",
          "description": "For business track, the public version it's based on"
        }
      }
    },
    
    "deliverable": {
      "type": "object",
      "description": "Work item",
      "required": ["name"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique deliverable identifier"
        },
        "$id": {
          "type": "string",
          "description": "URN identifier"
        },
        "name": {
          "type": "string",
          "description": "Deliverable name"
        },
        "type": {
          "type": "string",
          "enum": ["feature", "infrastructure", "documentation", "fix", "refactor"],
          "default": "feature",
          "description": "Work type classification"
        },
        "owner": {
          "type": "string",
          "default": "team",
          "description": "Responsible person or team"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "review", "complete", "blocked", "deferred"],
          "description": "Current status"
        },
        "progress": {
          "type": "string",
          "description": "Progress percentage"
        },
        "featureId": {
          "type": "string",
          "description": "Parent feature ID"
        },
        "targetReleaseId": {
          "type": "string",
          "description": "Target release version"
        },
        "feature": {
          "type": "string",
          "description": "Feature name reference"
        },
        "priority": {
          "type": ["integer", "string"],
          "description": "Priority (1=highest or 'critical')"
        },
        "hours": {
          "type": "integer",
          "minimum": 0,
          "description": "Estimated effort hours"
        },
        "targetDate": {
          "type": "string",
          "description": "Target completion date"
        },
        "completedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Completion timestamp"
        },
        "evidence": {
          "type": ["array", "string"],
          "items": { "type": "string" },
          "description": "Verification criteria or links"
        },
        "value": {
          "type": "object",
          "description": "Business value metrics"
        },
        "graphMetadata": {
          "type": "object",
          "description": "Graph edge metadata for future Neo4j migration"
        }
      }
    },
    
    "quarter": {
      "type": "object",
      "required": ["focus"],
      "properties": {
        "focus": {
          "type": "string",
          "description": "Quarter focus area"
        },
        "theme": {
          "type": "string",
          "description": "Quarter theme"
        },
        "phases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Phase references"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "active", "complete"],
          "description": "Quarter status"
        },
        "milestones": {
          "type": "array",
          "items": { "$ref": "#/definitions/quarterMilestone" }
        },
        "deliverables": {
          "type": "array",
          "items": { "$ref": "#/definitions/deliverable" }
        },
        "metrics": {
          "type": "object",
          "additionalProperties": true
        },
        "resources": {
          "type": "object",
          "properties": {
            "team": { "type": ["integer", "string"] },
            "budget": { "type": "string" }
          }
        },
        "risks": {
          "type": "array",
          "items": { "$ref": "#/definitions/risk" }
        },
        "dependencies": {
          "type": "array",
          "items": { "$ref": "#/definitions/dependency" }
        },
        "erikHours": {
          "type": "integer",
          "minimum": 0,
          "maximum": 80,
          "description": "Erik's weekly hours"
        }
      }
    },
    
    "quarterMilestone": {
      "type": "object",
      "required": ["event"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique milestone identifier"
        },
        "date": {
          "type": "string",
          "description": "Target date"
        },
        "event": {
          "type": "string",
          "description": "Milestone name"
        },
        "gate": {
          "type": "boolean",
          "default": false,
          "description": "Go/no-go decision point"
        },
        "critical": {
          "type": "boolean",
          "default": false,
          "description": "Critical path"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "complete", "blocked"],
          "description": "Milestone status"
        },
        "type": {
          "type": "string",
          "enum": ["technical", "business", "funding", "team", "launch", "release"],
          "description": "Milestone category"
        },
        "dependsOn": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Dependent milestone IDs"
        }
      }
    },
    
    "keyMilestone": {
      "type": "object",
      "required": ["date", "event"],
      "properties": {
        "id": {
          "type": "string",
          "description": "Milestone identifier"
        },
        "date": {
          "type": "string"
        },
        "event": {
          "type": "string"
        },
        "quarter": {
          "type": "string",
          "pattern": "^q[1-4]_20[0-9]{2}$"
        },
        "gate": {
          "type": "boolean"
        },
        "critical": {
          "type": "boolean"
        },
        "status": {
          "type": "string",
          "enum": ["planned", "in-progress", "complete", "blocked"]
        }
      }
    },
    
    "risk": {
      "type": "object",
      "required": ["risk"],
      "properties": {
        "risk": { "type": "string" },
        "probability": {
          "type": "string",
          "enum": ["low", "medium", "medium-high", "high", "critical"]
        },
        "impact": {
          "type": "string",
          "enum": ["low", "medium", "medium-high", "high", "critical"]
        },
        "mitigation": { "type": "string" }
      }
    },
    
    "dependency": {
      "type": "object",
      "required": ["type"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["upstream", "downstream", "cross-venture", "internal", "external"]
        },
        "ventureId": { "type": "string" },
        "milestone": { "type": "string" },
        "blocking": { "type": "boolean", "default": false }
      }
    },
    
    "venture": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["Platform", "Application", "Hardware", "Hardware + SaaS", "Service", "Marketplace", "Protocol", "Holding", "SaaS"]
        },
        "architecture": {
          "type": "string",
          "enum": ["Cloud-First", "Cloud-Native", "Edge-First", "Hybrid", "API-Only", "Platform"]
        },
        "status": {
          "type": "string",
          "enum": ["active", "paused", "archived", "pre-formation", "pre-seed", "r&d", "poc", "concept"]
        },
        "forkParent": {
          "type": ["string", "null"]
        },
        "codeReuse": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100
        },
        "strategicThesis": {
          "type": "string",
          "description": "Strategic thesis statement"
        },
        "domain": {
          "type": "string",
          "format": "hostname"
        },
        "repository": {
          "type": "string",
          "format": "uri"
        },
        "platformProgress": { "type": "string" },
        "currentPhase": { "type": "string" }
      }
    },
    
    "pitch": {
      "type": "object",
      "properties": {
        "oneLiner": { "type": "string", "maxLength": 150 },
        "problem": { "type": "string" },
        "solution": { "type": "string" },
        "market": { "type": "string" },
        "differentiator": { "type": "string" },
        "businessModel": { "type": "string" },
        "evolutionPath": { "type": "string" },
        "traction": { "type": "string" },
        "ask": { "type": "string" },
        "technology": { "type": "string" }
      }
    }
  }
}
